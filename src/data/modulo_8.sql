-- [Modulo 8] Anonimizador de los datos.
-- Opcional

CREATE TABLE processed.data_set_anonimizado AS
SELECT
    SUM
        (CASE WHEN id_estudiante >= 0 THEN 1 END)
        OVER
        (ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW )
        AS id,
        PERIODO_INICIO, EDAD, ESTADO_CIVIL, GENERO, RESIDENCIA, ESTRATO, PIH_0, PNF_0, TR_0, PIH_1, PNF_1, TR_1, PIH_2, PNF_2, TR_2, PIH_3, PNF_3, TR_3, PIH_4, PNF_4, TR_4, PIH_5, PNF_5, TR_5, PIH_6, PNF_6, TR_6, PIH_7, PNF_7, TR_7, PIH_8, PNF_8, TR_8, PIH_9, PNF_9, TR_9, PIH_10, PNF_10, TR_10, PIH_11, PNF_11, TR_11, PIH_12, PNF_12, TR_12, PIH_13, PNF_13, TR_13, PIH_14, PNF_14, TR_14, PIH_15, PNF_15, TR_15, PIH_16, PNF_16, TR_16, PIH_17, PNF_17, TR_17, PIH_18, PNF_18, TR_18, PIH_19, PNF_19, TR_19, PIH_20, PNF_20, TR_20, PIH_21, PNF_21, TR_21, PIH_22, PNF_22, TR_22, PIH_23, PNF_23, TR_23, PIH_24, PNF_24, TR_24, PIH_25, PNF_25, TR_25, PIH_26, PNF_26, TR_26, PIH_27, PNF_27, TR_27, PIH_28, PNF_28, TR_28, PIH_29, PNF_29, TR_29, PIH_30, PNF_30, TR_30, PIH_31, PNF_31, TR_31, PIH_32, PNF_32, TR_32, PIH_33, PNF_33, TR_33, PIH_34, PNF_34, TR_34, PIH_35, PNF_35, TR_35, PIH_36, PNF_36, TR_36, PIH_37, PNF_37, TR_37, PIH_38, PNF_38, TR_38, PIH_39, PNF_39, TR_39, PIH_40, PNF_40, TR_40, PIH_41, PNF_41, TR_41, PIH_42, PNF_42, TR_42, PIH_43, PNF_43, TR_43, PIH_44, PNF_44, TR_44, PIH_45, PNF_45, TR_45, PIH_46, PNF_46, TR_46, PIH_47, PNF_47, TR_47, PIH_48, PNF_48, TR_48, PIH_49, PNF_49, TR_49, PIH_50, PNF_50, TR_50, PIH_51, PNF_51, TR_51, PIH_52, PNF_52, TR_52, PIH_53, PNF_53, TR_53, PIH_54, PNF_54, TR_54, PIH_55, PNF_55, TR_55, PIH_56, PNF_56, TR_56, PIH_57, PNF_57, TR_57, PIH_58, PNF_58, TR_58, PIH_59, PNF_59, TR_59, PIH_60, PNF_60, TR_60, PIH_61, PNF_61, TR_61, PIH_62, PNF_62, TR_62, PIH_63, PNF_63, TR_63, PIH_64, PNF_64, TR_64, PIH_65, PNF_65, TR_65, PIH_66, PNF_66, TR_66, ESTADO_FINAL
FROM processed.data_set;